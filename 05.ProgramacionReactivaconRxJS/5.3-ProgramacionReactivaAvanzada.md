# Programación reactiva avanzada

## Creación y gestión de observables
Un **Observable** es una colección de valores o eventos que pueden ser **emitidos en el tiempo**, y a los cuales uno se puede **suscribir** para reaccionar a ellos.
> Es como una radio: vos te sintonizás (te suscribís) y escuchás lo que emite (los valores).

### 🛠️ Creación de Observables
```ts
import { Observable } from 'rxjs';

const observable = new Observable(observer => {
  observer.next('Hola');
  observer.next('Mundo');
  observer.complete();
});
```

###  Usando funciones auxiliares (of, from)
```ts
import { of, from } from 'rxjs';

const obs1 = of(1, 2, 3); // Emite valores individuales
const obs2 = from([10, 20, 30]); // Emite cada valor de un array
```

### 👂 Suscripción a un Observable
```ts
obs1.subscribe({
  next: valor => console.log('Valor:', valor),
  error: err => console.error('Error:', err),
  complete: () => console.log('Completado')
});
```
También podés suscribirte con una función directa si no necesitas manejar errores:
```ts
obs2.subscribe(valor => console.log(valor));
```

## 🔄 Operadores comunes de RxJS

| Operador     | Uso principal                                                  |
|--------------|----------------------------------------------------------------|
| `map`        | Transformar valores emitidos.                                  |
| `tap`        | Depurar o realizar acciones secundarias.                       |
| `forkJoin`   | Esperar múltiples observables a la vez.                        |
| `mergeMap`   | Combinar flujos múltiples (sin cancelar anteriores).           |
| `switchMap`  | Cancelar solicitudes anteriores y mantener solo la última.     |

> 📌 **Clave de éxito:** Usar correctamente `pipe` con operadores de **RxJS** te da control total sobre el flujo de datos y mejora la performance de tu app.

## 🧠 Diferencias entre Observables y Subjects

| Característica   | Observables                                 | Subjects                                     |
|------------------|---------------------------------------------|----------------------------------------------|
| **Rol**          | Solo productor de datos                     | Productor y consumidor de datos              |
| **Suscriptores** | Cada uno recibe valores de forma independiente | Todos reciben el mismo flujo de datos     |
| **Creación**     | Usados en tareas específicas                | Usados para compartir estados globales       |


## ⚔️ `mergeMap` vs `switchMap`

| Operador    | Comportamiento                          |
|-------------|------------------------------------------|
| `mergeMap`  | Conserva todas las suscripciones.        |
| `switchMap` | Cancela suscripciones anteriores.        |

## 🧪 Ejemplo práctico: Fetch con Observables en Angular
```ts
this.http.get('https://jsonplaceholder.typicode.com/users')
  .pipe(
    tap(() => console.log('Cargando usuarios...')),
    map((res: any) => res.slice(0, 5))
  )
  .subscribe(data => {
    this.usuarios = data;
  });
```

## 🧼 Cancelar suscripciones
Si no gestionás bien tus suscripciones, te vas a comer un memory leak 🍝.
```ts
import { Subscription } from 'rxjs';

export class MiComponente {
  private sub!: Subscription;

  ngOnInit() {
    this.sub = this.servicio.getDatos().subscribe(data => {
      console.log(data);
    });
  }

  ngOnDestroy() {
    this.sub.unsubscribe(); // ¡Liberá memoria!
  }
}
```

## ✅ Resumen

- Los **Observables** permiten trabajar con **flujos de datos asíncronos**.
- Se pueden crear con `new Observable`, `of`, `from`, etc.
- Se gestionan con operadores como `map`, `tap`, `mergeMap`, etc., y se consumen con `subscribe`.
- ⚠️ Siempre recordá **cancelar las suscripciones** para evitar problemas de memoria (memory leaks).

> 🚀 **Dominar los Observables es clave para hacer apps Angular limpias, reactivas y bien organizadas.**

